---
title: "Data Manipulation with R"
subtitle: "BioMarin Meetup: transforming, reformatting, and calculating variables"
author: 
  - "Martin Frigaard"
date: '`r Sys.Date()`'
output:
  xaringan::moon_reader:
    css: xaringan-themer.css
---

```{r setup, include=FALSE}
library(tidyverse)
library(reprex)
library(xaringan)
library(pagedown)
library(xaringanthemer)
# folders
folders <- c("code", "data", "img", "docs", "pdfs")
purrr::map(.x = folders, .f = fs::dir_create)
# chunk options
knitr::opts_chunk$set(warning = FALSE, message = FALSE, fig.align = "center", 
                      dpi = 320, fig.height = 4, fig.path = "img/")
# set options
options(htmltools.dir.version = FALSE, 
        tibble.max_extra_cols = 6,
        ibble.print_max = 6,
        tibble.width = 60)
```
class: middle, center

```{r xaringan-themer, include=FALSE, warning=FALSE}
xaringanthemer::style_duo_accent(primary_color = "#035AA6", secondary_color = "#03A696")
# xaringan::inf_mr() # for instant knitting and reviewing
```

```{r inf_mr, eval=FALSE, include=FALSE}
xaringan::inf_mr()
```

class: inverse, center, bottom
background-image: url(img/dplyr.png)
background-position: 50% 10%
background-size: 35%

# `dplyr` = a grammar for data manipulation

---
class: left, top
background-image: url(img/dplyr.png)
background-position: 95% 10%
background-size: 9%

# What are common data manipulation tasks?

### 1). Choose columns from a dataset 

### 2). Choose rows from a dataset  

### 3). Order rows (either alphabetically or numerically)

### 4). Reformat/change values  

### 5). Create or calculate new columns 

---
class: left, top
background-image: url(img/dplyr.png)
background-position: 95% 10%
background-size: 9%

# `dplyr` = "dee + ply + ARRRR"

<br>

.pull-left[

### *Pliers* are tools for grasping or manipulating common objects 

### The `dplyr` package has a variety of verbs for performing common data manipulations

]

--

<br>

.pull-right[

```{r pliers, out.height='80%', out.width='80%', echo=FALSE}
knitr::include_graphics(path = "img/pliers.png")
```

]

---
class: left, top
background-image: url(img/dplyr.png)
background-position: 90% 10%
background-size: 9%

# The `starwars` dataset  

### These data come from the Star Wars API: 

```{r star-wars-jpeg, out.height='60%', out.width='60%', echo=FALSE}
knitr::include_graphics(path = "img/star-wars.jpeg")
```

### Read more about the data here: https://dplyr.tidyverse.org/reference/starwars.html

---
class: left, top
background-image: url(img/dplyr.png)
background-position: 95% 9%
background-size: 9%

# Load the `starwars` dataset

### The `starwars` data comes from the `dplyr` package, so we can access it using the code below:

```{r starwars-dplyr, eval=FALSE}
install.packages("dplyr")
library(dplyr)
starwars <- dplyr::starwars
```

--

### We'll use a smaller version of `starwars` to show `dplyr`'s common data manipluation verbs


---
class: left, top
background-image: url(img/dplyr.png)
background-position: 5% 95%
background-size: 7%

# Importing `orginal_starwars` 

You can access the .csv file using the link below: 

```{r orginal_starwars, eval=FALSE}
library(readr)
orginal_starwars <- read_csv("data/orginal-starwars.csv")
orginal_starwars
```

```{r paged_table_orginal_starwars, echo=FALSE}
rmarkdown::paged_table(orginal_starwars)
```

---
class: left, top
background-image: url(img/dplyr.png)
background-position: 5% 95%
background-size: 7%

## After running the `read_csv()` function, we have the dataset in our ***Environment*** pane

```{r starwars-env, out.height='90%', out.width='90%', echo=FALSE}
knitr::include_graphics(path = "img/starwars-env.png")
```

---
class: left, top
background-image: url(img/dplyr.png)
background-position: 95% 9%
background-size: 9%

# View the `starwars` dataset

#### You can view the `starwars` dataset using RStudio's data editor

```{r starwars-dataviewer, out.height='70%', out.width='70%', echo=FALSE}
knitr::include_graphics(path = "img/starwars-dataviewer.png")
```



---
class: left, top
background-image: url(img/dplyr.png)
background-position: 95% 9%
background-size: 9%

# View the `starwars` dataset

#### Take a look at the dataset using `dplyr::glimpse()`

--

```{r starwars-glimpse}
glimpse(starwars)
```


---
class: left, top
background-image: url(img/dplyr.png)
background-position: 90% 10%
background-size: 9%

# `dplyr` verbs

## There are four primary verbs for data manipulation in `dplyr`

### `select()` 

### `filter()`  

### `arrange()` 

### `mutate()`

---
class: left, top
background-image: url(img/dplyr.png)
background-position: 95% 15%
background-size: 9%

## Select columns with `select()`

#### `select()` allows us to pick specific columns out of a dataset

```{r , eval=FALSE}
starwars %>% 
  select(name, homeworld, species)
```
```{r select-01, echo=FALSE}
rmarkdown::paged_table(
starwars %>% 
  select(name, homeworld, species) 
)
```

---
class: left, top
background-image: url(img/dplyr.png)
background-position: 95% 15%
background-size: 9%

## Select columns with `select()`

#### We can use negation to remove columns

```{r , eval=FALSE}
starwars %>% 
  select(-c(films, vehicles, starships))
```

```{r select-02, echo=FALSE}
rmarkdown::paged_table(
starwars %>% 
  select(-c(films, vehicles, starships))
)
```



---
class: left, top
background-image: url(img/dplyr.png)
background-position: 7% 95%
background-size: 9%

# Filter rows with `filter()`

---
class: left, top
background-image: url(img/dplyr.png)
background-position: 7% 95%
background-size: 9%

# Sort rows with `arrange()`

---
class: left, top
background-image: url(img/dplyr.png)
background-position: 7% 95%
background-size: 9%

# Create columns with `mutate()`